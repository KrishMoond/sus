{% extends 'base.html' %}

{% block title %}Admin Dashboard{% endblock %}

{% block content %}
<div style="margin-bottom: 2rem;">
    <h1 style="color: var(--accent-2); font-size: 2.5rem; margin-bottom: 0.5rem;">üõ°Ô∏è Admin Dashboard</h1>
    <p style="color: var(--muted); font-size: 1.1rem;">Manage your sustainability community</p>
</div>

<!-- Statistics Cards -->
<div class="grid" style="grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); margin-bottom: 3rem;">
    <div class="card" style="text-align: center; padding: 1.5rem; background: linear-gradient(135deg, rgba(45,134,89,0.15), rgba(35,139,78,0.1));">
        <div style="font-size: 2.5rem; font-weight: bold; color: var(--accent-2);">{{ total_users }}</div>
        <div style="color: var(--muted); margin-top: 0.5rem;">Total Users</div>
        <div style="color: var(--accent-2); font-size: 0.9rem; margin-top: 0.5rem;">{{ new_users_7d }} new (7d)</div>
    </div>
    
    <div class="card" style="text-align: center; padding: 1.5rem; background: linear-gradient(135deg, rgba(23,162,184,0.15), rgba(17,132,150,0.1));">
        <div style="font-size: 2.5rem; font-weight: bold; color: #bfe9ff;">{{ active_users_30d }}</div>
        <div style="color: var(--muted); margin-top: 0.5rem;">Active Users (30d)</div>
    </div>
    
    <div class="card" style="text-align: center; padding: 1.5rem; background: linear-gradient(135deg, rgba(45,134,89,0.15), rgba(35,139,78,0.1));">
        <div style="font-size: 2.5rem; font-weight: bold; color: var(--accent-2);">{{ total_projects }}</div>
        <div style="color: var(--muted); margin-top: 0.5rem;">Total Projects</div>
    </div>
    
    <div class="card" style="text-align: center; padding: 1.5rem; background: linear-gradient(135deg, rgba(45,134,89,0.15), rgba(35,139,78,0.1));">
        <div style="font-size: 2.5rem; font-weight: bold; color: var(--accent-2);">{{ total_events }}</div>
        <div style="color: var(--muted); margin-top: 0.5rem;">Total Events</div>
    </div>
    
    <div class="card" style="text-align: center; padding: 1.5rem; background: linear-gradient(135deg, rgba(45,134,89,0.15), rgba(35,139,78,0.1));">
        <div style="font-size: 2.5rem; font-weight: bold; color: var(--accent-2);">{{ total_topics }}</div>
        <div style="color: var(--muted); margin-top: 0.5rem;">Forum Topics</div>
    </div>
    
    <div class="card" style="text-align: center; padding: 1.5rem; background: linear-gradient(135deg, rgba(45,134,89,0.15), rgba(35,139,78,0.1));">
        <div style="font-size: 2.5rem; font-weight: bold; color: var(--accent-2);">{{ total_resources }}</div>
        <div style="color: var(--muted); margin-top: 0.5rem;">Resources</div>
    </div>
</div>

<!-- Quick Actions -->
<div class="card" style="margin-bottom: 3rem;">
    <h2 style="color: var(--accent-2); margin-bottom: 1.5rem;">‚ö° Quick Actions</h2>
    <div style="display: flex; gap: 1rem; flex-wrap: wrap;">
        <a href="{% url 'admin:index' %}" class="btn" target="_blank">Django Admin Panel</a>
        <a href="{% url 'forums:categories' %}" class="btn">Manage Categories</a>
        <a href="{% url 'forums:category_create' %}" class="btn">Create Category</a>
        <a href="{% url 'moderation:reports' %}" class="btn">View Reports</a>
    </div>
</div>

<!-- Recent Activity -->
<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 2rem; margin-bottom: 3rem;">
    <div class="card">
        <h3 style="color: var(--accent-2); margin-bottom: 1rem;">üöÄ Recent Projects</h3>
        <div style="display: flex; flex-direction: column; gap: 1rem;">
            {% for project in recent_projects %}
                <div style="padding: 1rem; background: rgba(255,255,255,0.03); border-radius: 12px;">
                    <a href="{% url 'projects:detail' pk=project.pk %}" style="color: var(--accent-2); text-decoration: none; font-weight: 600;">{{ project.title }}</a>
                    <p style="color: var(--muted); font-size: 0.9rem; margin: 0.5rem 0;">by {{ project.creator.username }}</p>
                    <span style="color: var(--muted); font-size: 0.85rem;">{{ project.created_at|timesince }} ago</span>
                </div>
            {% empty %}
                <p style="color: var(--muted);">No projects yet.</p>
            {% endfor %}
        </div>
    </div>
    
    <div class="card">
        <h3 style="color: var(--accent-2); margin-bottom: 1rem;">üìÖ Recent Events</h3>
        <div style="display: flex; flex-direction: column; gap: 1rem;">
            {% for event in recent_events %}
                <div style="padding: 1rem; background: rgba(255,255,255,0.03); border-radius: 12px;">
                    <a href="{% url 'events:detail' pk=event.pk %}" style="color: var(--accent-2); text-decoration: none; font-weight: 600;">{{ event.title }}</a>
                    <p style="color: var(--muted); font-size: 0.9rem; margin: 0.5rem 0;">by {{ event.organizer.username }}</p>
                    <span style="color: var(--muted); font-size: 0.85rem;">{{ event.created_at|timesince }} ago</span>
                </div>
            {% empty %}
                <p style="color: var(--muted);">No events yet.</p>
            {% endfor %}
        </div>
    </div>
    
    <div class="card">
        <h3 style="color: var(--accent-2); margin-bottom: 1rem;">üí¨ Recent Topics</h3>
        <div style="display: flex; flex-direction: column; gap: 1rem;">
            {% for topic in recent_topics %}
                <div style="padding: 1rem; background: rgba(255,255,255,0.03); border-radius: 12px;">
                    <a href="{% url 'forums:topic_detail' pk=topic.pk %}" style="color: var(--accent-2); text-decoration: none; font-weight: 600;">{{ topic.title }}</a>
                    <p style="color: var(--muted); font-size: 0.9rem; margin: 0.5rem 0;">by {{ topic.author.username }}</p>
                    <span style="color: var(--muted); font-size: 0.85rem;">{{ topic.created_at|timesince }} ago</span>
                </div>
            {% empty %}
                <p style="color: var(--muted);">No topics yet.</p>
            {% endfor %}
        </div>
    </div>
</div>

<!-- Most Active Users -->
<div class="card">
    <h3 style="color: var(--accent-2); margin-bottom: 1rem;">üë• Most Active Users</h3>
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem;">
        {% for user in most_active_users %}
            <div style="padding: 1rem; background: rgba(255,255,255,0.03); border-radius: 12px;">
                <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 0.5rem;">
                    {% if user.avatar %}
                        <img src="{{ user.avatar.url }}" alt="{{ user.username }}" style="width: 40px; height: 40px; border-radius: 50%; object-fit: cover;">
                    {% else %}
                        <div style="width: 40px; height: 40px; border-radius: 50%; background: linear-gradient(135deg, var(--accent), var(--accent-2)); display: flex; align-items: center; justify-content: center; font-weight: bold;">
                            {{ user.username|first|upper }}
                        </div>
                    {% endif %}
                    <a href="{% url 'profiles:detail' username=user.username %}" style="color: var(--accent-2); text-decoration: none; font-weight: 600;">{{ user.username }}</a>
                </div>
                <div style="color: var(--muted); font-size: 0.9rem;">
                    {% if user.topics_count %}<span>{{ user.topics_count }} topics</span>{% endif %}
                    {% if user.projects_count %}<span style="margin-left: 0.5rem;">{{ user.projects_count }} projects</span>{% endif %}
                    {% if user.events_count %}<span style="margin-left: 0.5rem;">{{ user.events_count }} events</span>{% endif %}
                </div>
            </div>
        {% empty %}
            <p style="color: var(--muted);">No active users yet.</p>
        {% endfor %}
    </div>
</div>
{% endblock %}

