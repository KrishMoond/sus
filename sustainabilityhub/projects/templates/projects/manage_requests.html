{% extends 'base.html' %}

{% block title %}Manage Join Requests - {{ project.title }}{% endblock %}

{% block content %}
<div class="card">
    <h1 style="margin-bottom: 1.5rem; color: var(--accent-2);">Manage Join Requests for "{{ project.title }}"</h1>
    <p style="color: var(--muted); margin-bottom: 2rem;">Review requests from users who want to join your project.</p>

    {% if requests %}
        <div style="display: flex; flex-direction: column; gap: 1.5rem;">
            {% for req in requests %}
                <div style="padding: 1.5rem; background: rgba(255,255,255,0.03); border-radius: 12px; border-left: 3px solid rgba(23,162,184,0.5);">
                    <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 1rem; margin-bottom: 1rem;">
                        <div style="display: flex; align-items: center; gap: 1rem;">
                            {% if req.user.avatar %}
                                <img src="{{ req.user.avatar.url }}" alt="{{ req.user.username }}" style="width: 50px; height: 50px; border-radius: 50%; object-fit: cover;">
                            {% else %}
                                <div style="width: 50px; height: 50px; border-radius: 50%; background: linear-gradient(135deg, var(--accent), var(--accent-2)); display: flex; align-items: center; justify-content: center; font-weight: bold; font-size: 1.2rem;">
                                    {{ req.user.username|first|upper }}
                                </div>
                            {% endif %}
                            <div>
                                <a href="{% url 'profiles:detail' username=req.user.username %}" style="color: var(--accent-2); text-decoration: none; font-weight: 600; font-size: 1.1rem;">
                                    {{ req.user.username }}
                                </a>
                                <span style="color: var(--muted); font-size: 0.9rem; display: block; margin-top: 0.25rem;">Requested {{ req.created_at|timesince }} ago</span>
                            </div>
                        </div>
                        <div style="display: flex; gap: 0.75rem; flex-wrap: wrap;">
                            <form method="post" action="{% url 'projects:approve_request' pk=req.pk %}" style="display: inline;">
                                {% csrf_token %}
                                <button type="submit" class="btn" style="padding: 0.75rem 1.5rem;">‚úÖ Approve</button>
                            </form>
                            <form method="post" action="{% url 'projects:reject_request' pk=req.pk %}" style="display: inline;">
                                {% csrf_token %}
                                <button type="submit" class="btn btn-danger" style="padding: 0.75rem 1.5rem;">‚ùå Reject</button>
                            </form>
                        </div>
                    </div>
                    {% if req.message %}
                        <div style="margin-top: 1rem; padding: 1rem; background: rgba(255,255,255,0.05); border-radius: 8px; border-left: 3px solid rgba(255,255,255,0.2);">
                            <strong style="color: var(--accent-2);">Message:</strong>
                            <p style="color: rgba(255,255,255,0.9); margin: 0.5rem 0 0 0;">{{ req.message|linebreaksbr }}</p>
                        </div>
                    {% endif %}
                </div>
            {% endfor %}
        </div>
    {% else %}
        <div style="text-align: center; padding: 3rem; color: var(--muted);">
            <div style="font-size: 4rem; margin-bottom: 1rem;">üéâ</div>
            <h2 style="color: var(--accent-2); margin-bottom: 0.5rem;">No pending requests!</h2>
            <p style="font-size: 1.2rem;">All caught up. Check back later for new requests.</p>
        </div>
    {% endif %}

    <a href="{% url 'projects:detail' pk=project.pk %}" class="btn btn-secondary" style="margin-top: 2rem;">‚Üê Back to Project</a>
</div>
{% endblock %}

